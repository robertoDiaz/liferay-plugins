YUI.add("aui-image-filter-canvas",function(e,t){var n=e.Lang,r="image-filter-canvas",i=e.Base.create(r,e.ImageFilterBase,[],{initializer:function(){var t=this,n=t.get("containerNode");t._canvas=e.config.doc.createElement("canvas"),t._ctx=t._canvas.getContext("2d");var r=n.one("img"),i=r.attr("src"),s=t._canvas;s.setAttribute("width",500),s.setAttribute("height",300),context=t._ctx,context.drawImage(r.getDOMNode(),0,0),n.empty(),n.append(s),t._initialData=context.getImageData(0,0,500,300),t._currentData=t._cloneImageData(t._initialData),t._previewData=t._cloneImageData(t._initialData)},clear:function(){var e=this;e._ctx.putImageData(e._currentData,0,0),e._updateState("clear",e._previewData,e._currentData)},getImage:function(){var e=this;return e._cloneImageData(e._previewData)},getImageData:function(){var e=this;return e._canvas.toDataURL()},preview:function(e,t,n){var r=this,i=r[e];i&&i.process&&(r._previewData.data.set(r._currentData.data),i.process(r._previewData,t),r._ctx.putImageData(r._previewData,0,0),r._updateState("preview",r._currentData,r._previewData))},putImage:function(e,t,n){var r=this,t=t||0,n=n||0;r._currentData.data.set(e.data),r._previewData.data.set(e.data),r._ctx.putImageData(e,t,n)},reset:function(){var e=this;e._ctx.putImageData(e._initialData,0,0),e._currentData.data.set(e._initialData.data),e._updateState("reset",e._previewData,e._initialData)},save:function(){var e=this;e._updateState("save",e._currentData,e._previewData),e._currentData.data.set(e._previewData.data)},_cloneImageData:function(e){var t=this,n=t._ctx.createImageData(e.width,e.height);return n.data.set(e.data),n},_updateState:function(e,t,n){var r=this;r._notifyStateChange(e,r._cloneImageData(t),r._cloneImageData(n))}},{});e.ImageFilterCanvas=i},"2.0.0");
