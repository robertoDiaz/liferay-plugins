YUI.add("aui-image-processor-canvas",function(e,t){var n=e.Lang,r="image-processor-canvas",i=e.Base.create(r,e.ImageProcessorBase,[],{initializer:function(){var t=this,n=t.get("imageNode"),r=t.get("srcNode"),i,s,o,u;r&&n&&(o=n.width(),u=n.height(),i=e.config.doc.createElement("canvas"),s=i.getContext("2d"),i.setAttribute("width",o),i.setAttribute("height",u),s.drawImage(n.getDOMNode(),0,0),n.hide(),r.append(i),t._canvas=i,t._ctx=s,t._initialData=s.getImageData(0,0,o,u),t._currentData=t._cloneImageData(t._initialData),t._previewData=t._cloneImageData(t._initialData))},clear:function(){var e=this;e._ctx.putImageData(e._currentData,0,0),e._updateState("clear",e._previewData,e._currentData)},getImage:function(){var e=this;return e._cloneImageData(e._previewData)},getImageData:function(){var e=this;return e._canvas.toDataURL()},preview:function(e,t,n){var r=this,i=r[e];i&&i.process&&(r._previewData.data.set(r._currentData.data),i.process(r._previewData,t),r._ctx.putImageData(r._previewData,0,0),r._updateState("preview",r._currentData,r._previewData))},putImage:function(e,t,n){var r=this,t=t||0,n=n||0;r._currentData.data.set(e.data),r._previewData.data.set(e.data),r._ctx.putImageData(e,t,n)},reset:function(){var e=this;e._ctx.putImageData(e._initialData,0,0),e._currentData.data.set(e._initialData.data),e._updateState("reset",e._previewData,e._initialData)},save:function(){var e=this;e._updateState("save",e._currentData,e._previewData),e._currentData.data.set(e._previewData.data)},_cloneImageData:function(e){var t=this,n=t._ctx.createImageData(e.width,e.height);return n.data.set(e.data),n},_updateState:function(e,t,n){var r=this;r._notifyStateChange(e,r._cloneImageData(t),r._cloneImageData(n))}},{});e.ImageProcessorCanvas=i},"2.0.0");
